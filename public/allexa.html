<button onclick="recognition.start()">Listen</button>
<script>
var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition
var recognition = new SpeechRecognition();

recognition.lang = "pl-PL";
recognition.continuous = false;
recognition.interimResults = true;

recognition.onresult = function(event) {
  for (var i = event.resultIndex; i < event.results.length; i++) {
    if(event.results[i].isFinal){
      // /commands/hipchat
      console.log(event.results[i][0].transcript);
      var body = {
      	item: {
        	message: {
          	message: event.results[i][0].transcript.replace('lebkuchen', '/fm x').toLowerCase()
          }
        }
      };

      console.log('fetch');
      fetch('https://lebkuchen-fm-service-yjt4m1xsw.herokuapp.com/commands/hipchat', {
      	method: 'POST',
        body: JSON.stringify(body),
        headers: { 'Content-Type': 'application/json' }
      });
    }
	}
}
recognition.onstart = function(event) { console.log(event); }
recognition.onerror = function(event) { console.log(event); }
recognition.onend = function(event) { console.log(event); }
</script>
